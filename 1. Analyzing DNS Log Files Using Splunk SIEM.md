# 🔍 DNS Log Analysis with Splunk SIEM  

## 📌 Introduction  
DNS (Domain Name System) logs are essential for monitoring network activity and detecting suspicious or malicious behavior. Splunk SIEM provides a powerful platform to ingest, search, and analyze DNS logs for threat detection and anomaly detection.  

This guide walks through:  
1. Uploading DNS logs into Splunk  
2. Running basic queries  
3. Investigating anomalies and suspicious domains  

---

## ✅ Prerequisites  
Before starting, make sure you have:  
- A running **Splunk instance** (Enterprise, Free, or Splunk Cloud).  
- **DNS log data sources** (e.g., BIND, Windows DNS, Zeek/Suricata).  

---

## 📂 Uploading Sample DNS Logs into Splunk  

### 1. Prepare Log Files  
- Extract the sample `.json` file.  
- Ensure the logs contain fields such as `src_ip`, `dest_ip`, `fqdn`, `query_type`, `response_code`.  

### 2. Add Data to Splunk  
- Log in to **Splunk**.  
- Navigate: **Settings → Add Data → Upload**.  
- Select your **DNS log file**.  

### 3. Configure Input  
- **Source type** → Select `_json` (or create `dns_sample`).  
- **Index** → Choose (or create) a dedicated index, e.g., `dns_index`.  
- Review settings → ✅ Submit.  

### 4. Verify Data  
Run a quick search to confirm logs are ingested:  
```spl
index=dns_index sourcetype=_json
```

## 📊 Analyzing DNS Logs in Splunk

In this section, we will perform core analysis on the DNS logs to uncover trends, anomalies, and potential threats. These queries help in quickly identifying suspicious activity and understanding overall DNS traffic patterns. Each query builds on the previous one to provide deeper insights into the DNS ecosystem.

### 🔎 1. Search for DNS Events
Use this query to fetch all DNS events from your index:
```spl
index=dns_index sourcetype=dns_sample
```

### 📌 2. Extract Relevant Fields
Focus on relevant DNS-related fields to simplify analysis:
```spl
index=* sourcetype=_json | regex _raw="(?i)\b(dns|domain|query|response|port 53)\b"
```

### 📈 3. Identify Anomalies (Spikes in Queries)
Detect domains with unusually high query counts, which could indicate abuse or scanning:
```spl
index=* sourcetype=_json | stats count by query | sort - count
```

### 🌐 4. Find Top Queried Domains & Sources
Quickly identify the most frequently queried domains and source IPs:
```spl
index=* sourcetype=_json | top query, src_ip
```

### 🚨 5. Investigate Suspicious Domains
Zoom in on a specific suspicious domain for detailed investigation:
```spl
index=* sourcetype=_json query="office365.com"

```
## ✅ Conclusion

Analyzing DNS log files using Splunk SIEM enables security professionals to detect and respond to potential security incidents effectively. By understanding DNS activity and identifying anomalies, organizations can enhance their overall security posture and protect against various cyber threats.

Feel free to customize these steps according to your specific use case and requirements.

Happy analyzing!
